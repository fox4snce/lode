{% extends "base.html" %}

{% block title %}Help - Lode{% endblock %}

{% block content %}
<div class="menu-bar">
    <h1>Lode</h1>
    <div class="menu-items">
        <a href="/main">Main</a>
        <a href="/import">Import</a>
        <a href="/analytics">Analytics</a>
        <a href="/find-tools">Find Tools</a>
        <a href="/export">Export</a>
        <a href="/settings">Settings</a>
        <a href="/help">Help</a>
        <a href="/about">About</a>
    </div>
</div>

<div class="container">
    <div class="help-layout">
        <aside class="help-sidebar">
            <div class="card">
                <h3>Quick Navigation</h3>
                <ul class="help-nav">
                    <li><a href="#main-help">üì± Main</a></li>
                    <li><a href="#import-help">üì• Import</a></li>
                    <li><a href="#analytics-help">üìä Analytics</a></li>
                    <li><a href="#find-tools-help">üîç Find Tools</a></li>
                    <li><a href="#export-help">üíæ Export</a></li>
                    <li><a href="#settings-help">‚öôÔ∏è Settings</a></li>
                </ul>
            </div>
        </aside>

        <main class="help-content">
            <div class="card">
                <h2>Help & Documentation</h2>
                <p class="help-subtitle">MVP help: pragmatic, quick, and consistent with what the app actually does.</p>

                <section id="main-help" class="help-section">
                    <h3>üì± Main ‚Äî Conversation Viewer</h3>
                    <p class="help-subtitle">Browse, filter, and read conversations. Search updates as you type.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Left Panel ‚Äî Conversation List</h4>
                            <ul>
                                <li><strong>Search Box</strong>: Type to search conversations and messages. Results update as you type.</li>
                                <li><strong>Sort By</strong>: Recent / Oldest / Most Messages / Most Words</li>
                                <li><strong>AI Source Filter</strong>: OpenAI / Claude / All</li>
                                <li><strong>Starred Only</strong>: Show only starred conversations</li>
                                <li><strong>Conversation List</strong>: Click any conversation to view it</li>
                            </ul>
                        </div>

                        <div class="help-block">
                            <h4>Center Panel ‚Äî Messages</h4>
                            <ul>
                                <li>Displays messages for the selected conversation</li>
                                <li>Messages show role, timestamp, and content</li>
                                <li>When searching, matching terms are highlighted</li>
                                <li>When a search term is active, selecting a conversation scrolls to a matching message (when possible)</li>
                            </ul>
                        </div>

                        <div class="help-block help-tip">
                            <h4>Right Panel ‚Äî Conversation Details</h4>
                            <ul>
                                <li>Shows title, ID, source, and created/updated timestamps</li>
                                <li>Displays tags (if any)</li>
                                <li>Shows basic stats: message count and word count</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section id="import-help" class="help-section">
                    <h3>üì• Import</h3>
                    <p class="help-subtitle">Import OpenAI/Claude exports into your local database.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Steps</h4>
                            <ol>
                                <li><strong>Select Source Type</strong>: OpenAI or Claude</li>
                                <li><strong>Choose File</strong>: Browse files (preferred) or enter a file path</li>
                                <li><strong>Options</strong>: Calculate Statistics + Build Search Index (recommended)</li>
                                <li><strong>Start Import</strong></li>
                            </ol>
                        </div>

                        <div class="help-block help-tip">
                            <h4>What to expect</h4>
                            <ul>
                                <li>Imports run as background jobs</li>
                                <li>Status and progress appear on the Import page</li>
                                <li>Recent jobs are listed at the bottom</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section id="analytics-help" class="help-section">
                    <h3>üìä Analytics</h3>
                    <p class="help-subtitle">Explore usage patterns and content stats across your database.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Tabs</h4>
                            <ul>
                                <li><strong>Usage</strong>: conversations/messages/words over time</li>
                                <li><strong>Streaks</strong>: longest streak of active days</li>
                                <li><strong>Top Words</strong> / <strong>Top Phrases</strong></li>
                                <li><strong>Vocabulary</strong>: unique words over time</li>
                                <li><strong>Response Ratio</strong>: user vs assistant volume</li>
                                <li><strong>Time of Day</strong>: messages by hour</li>
                            </ul>
                        </div>

                        <div class="help-block help-tip">
                            <h4>Refresh behavior</h4>
                            <ul>
                                <li>Analytics are cached in the database</li>
                                <li>Click <strong>Refresh All Analytics</strong> once to recompute everything</li>
                                <li>After refresh, each tab loads instantly from cached results</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section id="find-tools-help" class="help-section">
                    <h3>üîç Find Tools</h3>
                    <p class="help-subtitle">Scan your entire corpus for specific patterns and structures.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Tools</h4>
                            <ul>
                                <li><strong>Code Blocks</strong>, <strong>Links</strong>, <strong>TODOs</strong></li>
                                <li><strong>Questions</strong>, <strong>Dates</strong>, <strong>Decisions</strong>, <strong>Prompts</strong></li>
                            </ul>
                        </div>

                        <div class="help-block help-tip">
                            <h4>Using results</h4>
                            <ul>
                                <li>Use search + date filters to narrow results</li>
                                <li>Use sorting to bring the most relevant items to the top</li>
                                <li>Click <strong>View ‚Üí</strong> to open the conversation and jump to the matching message</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section id="export-help" class="help-section">
                    <h3>üíæ Export</h3>
                    <p class="help-subtitle">Export a single conversation to Markdown/CSV/JSON.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Steps</h4>
                            <ol>
                                <li>Select a conversation</li>
                                <li>Choose format (Markdown/CSV/JSON)</li>
                                <li>Pick options: timestamps, metadata</li>
                                <li>Export, then copy or save</li>
                            </ol>
                        </div>

                        <div class="help-block help-tip">
                            <h4>Notes</h4>
                            <ul>
                                <li>Copy places content on your clipboard</li>
                                <li>Save downloads a file to your system</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section id="settings-help" class="help-section">
                    <h3>‚öôÔ∏è Settings</h3>
                    <p class="help-subtitle">Maintenance tools: integrity, dedupe, cleanup.</p>

                    <div class="help-kv">
                        <div class="help-block">
                            <h4>Integrity Checks</h4>
                            <ul>
                                <li>Scans for missing timestamps, broken threads, orphaned messages, duplicate IDs</li>
                            </ul>
                        </div>

                        <div class="help-block">
                            <h4>Deduplication</h4>
                            <ul>
                                <li>Find duplicate messages and conversations</li>
                                <li>Shows grouped results with IDs and previews</li>
                            </ul>
                        </div>

                        <div class="help-block help-tip">
                            <h4>Cleanup</h4>
                            <ul>
                                <li><strong>Wipe Imported Files</strong>: deletes raw import files (not the database)</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <div class="help-footer">
                    <p>Still stuck? Check <a href="/about">About</a> or open an issue for the next MVP pass.</p>
                    <a href="https://ko-fi.com/recursiverealms" target="_blank" class="btn btn-primary">Support on Ko-fi</a>
                </div>
            </div>
        </main>
    </div>
</div>
{% endblock %}
